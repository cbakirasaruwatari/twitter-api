#!/usr/bin/env python3
# -*- coding: utf-8 -*-

li = [
"1002365757991235584",
"1003181574",
"1004027916932403201",
"1006165519882338310",
"1010052226394423297",
"1010542593489321984",
"1010720638699360256",
"1011386809",
"1022926929932910592",
"1023103148498374656",
"1023131063499993089",
"1026456571276972033",
"1032628341973499904",
"1043680078989672448",
"1049518316857876480",
"1050000297139920898",
"1050657649295908865",
"1054497073",
"1057266550414049280",
"1058992663",
"1060774064434769921",
"106106172",
"1063432885",
"1064755885",
"1076298571081646081",
"1078979220",
"1079256551091691520",
"1084808755303174144",
"1091681303567552512",
"1094513653",
"1104806081966989313",
"111597022",
"111615106",
"1116217896965824513",
"111668026",
"112915715",
"1129579609006137344",
"113037873",
"114156603",
"1142950734",
"1143785093791506433",
"115048026",
"1156949661883572224",
"1161565214",
"116308955",
"1165128747885793281",
"1168739084",
"1170340072563953664",
"1173438291099537409",
"117418501",
"117487148",
"1176363253154213888",
"119275763",
"1201205251",
"120253767",
"121169126",
"122017563",
"122358022",
"1223995861",
"122921411",
"124036115",
"124107798",
"124378649",
"1244998357",
"125922993",
"1274194790",
"1276904594",
"127840880",
"129748601",
"130425780",
"130849268",
"1319831510",
"133081518",
"133279266",
"134413974",
"1361189166",
"136173753",
"1364561280",
"137335766",
"1381347674",
"1392035911",
"139416391",
"140735631",
"1407841680",
"142338541",
"142610125",
"1430673518",
"1434497419",
"144136956",
"1454173020",
"145809967",
"149740507",
"1499986633",
"15165940",
"152863338",
"1533491670",
"1540506470",
"155174670",
"1572715843",
"157335075",
"158066476",
"158077251",
"158147607",
"1602531290",
"160558493",
"160962113",
"161477470",
"162553218",
"1652755603",
"1655248188",
"1669522470",
"167143416",
"1675668884",
"168258909",
"1707841849",
"1725015038",
"1727236315",
"1730987394",
"173665319",
"173682659",
"173692673",
"176540449",
"177439645",
"177481645",
"183526120",
"185074438",
"185183985",
"185457741",
"188567060",
"189406902",
"191761480",
"1938602569",
"1960632164",
"1973754894",
"199496199",
"203451218",
"205165695",
"214794182",
"2154384624",
"215962504",
"2160002167",
"216671814",
"2190375847",
"219332374",
"2193779209",
"221649925",
"2231427091",
"2237482634",
"225472701",
"2266011733",
"226914702",
"2271762625",
"2273156257",
"228380580",
"231696450",
"2318172157",
"2318545308",
"232564566",
"2336816016",
"234323266",
"2351737910",
"236440864",
"2365784353",
"2366676458",
"2368802654",
"2369661536",
"237256263",
"2373659839",
"2383460678",
"2387815610",
"2390239315",
"2413541251",
"241378394",
"2416172311",
"2428681448",
"2431984032",
"2459460492",
"2491377019",
"250599971",
"2511747662",
"2530175407",
"2533128884",
"2533787994",
"2548509674",
"2549227374",
"256102804",
"2578152546",
"2578691329",
"2579504034",
"2609611399",
"266428076",
"268152851",
"269189302",
"2697672486",
"2706936132",
"272282968",
"272444085",
"2739881766",
"2758687375",
"2759327713",
"2776576698",
"2791221476",
"279440307",
"2798034134",
"2824337684",
"2829186612",
"284030356",
"2841380804",
"2843507287",
"2874456234",
"2879428224",
"2888067426",
"2891982738",
"2892015306",
"2895747889",
"2897140908",
"2898654648",
"2912137392",
"2914933819",
"2927655338",
"2929656242",
"2935924382",
"2951816384",
"295744378",
"2957598103",
"298340281",
"2984300665",
"302014985",
"3024876727",
"302632371",
"3056071687",
"3076343527",
"307722882",
"3094813026",
"3097483057",
"3099055592",
"3145507159",
"316501412",
"3166163570",
"3176837892",
"3195429668",
"320567011",
"322652574",
"3227563892",
"3232800368",
"3233518872",
"3236006401",
"3240430951",
"3245091103",
"3255743144",
"3266105852",
"326663568",
"3267024080",
"3267112214",
"3267164203",
"3267388976",
"3278052559",
"3279433807",
"3282821845",
"3283125823",
"328816404",
"3310248120",
"3313885398",
"3317150736",
"3336620952",
"3361286251",
"3411177194",
"3470272213",
"348120367",
"3494857274",
"3499971193",
"3503161512",
"354358441",
"358141111",
"369057283",
"3693507674",
"3746537173",
"376557649",
"384663094",
"384831568",
"385416589",
"394481967",
"396365132",
"397669299",
"404745370",
"405367501",
"4110759673",
"4125549614",
"4155113779",
"4159177394",
"420348223",
"4221088154",
"423644055",
"4244938814",
"4266258434",
"434118260",
"4441823832",
"44817903",
"4495554792",
"46294079",
"4634764284",
"4644809528",
"467359690",
"4677992652",
"4683322549",
"4689229358",
"4707997495",
"4712418630",
"4728521172",
"473821630",
"4761195644",
"4773737113",
"4787624496",
"4810271437",
"483601628",
"4851522733",
"4900713067",
"4902955908",
"491213998",
"497557586",
"502599730",
"504745616",
"546566489",
"548219009",
"552514181",
"55426834",
"559335341",
"5618812",
"564539398",
"567199936",
"569492200",
"570446565",
"57969346",
"591758372",
"594674922",
"60786030",
"631944680",
"694948099119149056",
"702026082132709376",
"705644024191815680",
"706294728786968576",
"706388571976937473",
"70639188",
"706630193666916352",
"707554213",
"711564763289886724",
"713517003793805312",
"713520083830595584",
"716496412431618048",
"720114594849677312",
"720991981397127170",
"721379764288626688",
"724259941",
"725207191293034496",
"726630337342627840",
"728925862599360512",
"73203442",
"733482565261099008",
"734954701",
"734959999705702400",
"735640286227922944",
"736688678924230656",
"736949043255906305",
"738276145729134596",
"739070891909255168",
"740834642132107264",
"743817596336693249",
"746595838957236224",
"748125523394461701",
"7489262",
"749999531777855492",
"750722954854477825",
"751542986194849792",
"753993065396707328",
"758893311494983680",
"761160886937542656",
"764294483311665158",
"764675050205093888",
"768447470305030144",
"769878431957790720",
"770836461016920064",
"771336667",
"773963515",
"774588944503615488",
"780079006188081152",
"782756798440706049",
"786057323110404096",
"787004191646416896",
"790929732065894401",
"794863989205237760",
"798569886",
"799904753253634049",
"800084186535051264",
"801823410909085696",
"802672248674918400",
"804583210512330752",
"805021979367485440",
"809406126231982080",
"812240838709252096",
"813241314",
"814896781821546496",
"816213654693548032",
"818070726028578816",
"82334177",
"827087490339135489",
"829285920",
"831011338927300609",
"834015672736718848",
"835589836627046400",
"839021994863538176",
"840360312301744129",
"840563930946658305",
"840775229697736704",
"842567001105022976",
"843082255039848448",
"843675139543711745",
"844756882208153603",
"844759485415546881",
"84489621",
"845689892692672512",
"848102395015974913",
"849395282169212928",
"849588960749731840",
"850121860201054209",
"85319955",
"854619760423690240",
"856711941355560961",
"862229966",
"863685021298606081",
"864692391139201024",
"865522165327609862",
"872018084105605120",
"87320135",
"874983510066380800",
"875960055954145280",
"879423715439656961",
"87964588",
"880650187483602945",
"881130366978867200",
"887368284391088128",
"889543127052111872",
"893775866408206336",
"894445742051295232",
"897866957860380672",
"901208443",
"901781342458753024",
"903305125715779584",
"903977984213770240",
"905168785",
"907088929358090240",
"907623445881536512",
"908552708033880064",
"910106667529801730",
"911658642079850497",
"911839427948724224",
"912572287148163072",
"912659999469445120",
"913590802260963329",
"914633929",
"91828665",
"919496523527815168",
"92148746",
"923436676021600257",
"925698624666742784",
"926840469954338817",
"927336655777755136",
"928248568883720195",
"928402606166237184",
"930905479135428608",
"93508858",
"936099554188976128",
"939829563328098304",
"940419022268514304",
"946095320",
"946844323307339776",
"949537880774291456",
"951461775592968192",
"95343570",
"957759532318392320",
"959765675358105602",
"960155786319032320",
"963618013",
"964308076370128896",
"965114896059805696",
"96686487",
"969594324324204544",
"971708640657747968",
"974539286509903873",
"974636065762951168",
"97487024",
"97652639",
"988239555483516928",
"988352493686996992",
"997316468",
"997705022245781504",
"998495711904739329",
"999613129985179648"
]


import configparser
import os
import mysql.connector as mydb

setting_path='../resource/twitter_api.cfg'
if os.path.isfile(setting_path) is False:
    raise FileNotFoundError
cfg = configparser.SafeConfigParser(os.environ)
cfg.read(setting_path)

class DBConnector():
    def connect(self):
        self.conn = mydb.connect(
        host=cfg["persistance_db"]["db_host"],
        port=cfg["persistance_db"]["db_port"],
        user=cfg["persistance_db"]["db_user"],
        password=cfg["persistance_db"]["db_password"],
        database=cfg["persistance_db"]["db_name"]
        )
        self.cursor = self.conn.cursor(dictionary=True)
    def close(self):
        self.conn.close()
        self.cursor.close()
    def commit(self):
        self.conn.commit()   
    def rollback(self):
         self.conn.rollback()


import json 
import sys

db=DBConnector()
db.connect()
for v in li:
    db.cursor.execute('''
SELECT
	f.user_id,
	f.follower_user_id,
	p.post
	
FROM
	twitter.post as p
	
INNER JOIN twitter.follower as f on f.user_id = %s and f.follower_user_id = p.user_id

    
    ''',[v])
    re = db.cursor.fetchall()
    try:
        with open("./twitter_data/" + str(v) + ".json",'w') as f:
            json.dump(re,f,indent=4,ensure_ascii=False)

    except Exception as e:
        print(e)
        sys.exit()
